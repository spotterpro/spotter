rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
  
    // 관리자(형님)의 UID를 함수로 정의합니다.
    function isAdmin() {
      return request.auth.uid == '2gu2P6Qea9diPk0KLeVwlJE1OFO2';
    }

    // 문서의 주인인지 확인하는 함수입니다.
    function isOwner(userId) {
      return request.auth.uid == userId;
    }

    // 'store_applications' 컬렉션에 대한 규칙입니다.
    match /store_applications/{userId} {
      // [수정] 읽기 권한은 관리자 또는 본인만 가능합니다.
      allow read: if isAdmin() || isOwner(userId);

      // 수정은 관리자만 가능합니다.
      allow update: if isAdmin();
      
      // 쓰기는 본인만 가능합니다.
      allow create: if isOwner(userId);

      // 삭제는 본인만 가능합니다. (재신청 시 필요)
      allow delete: if isOwner(userId);
    }
  }
}